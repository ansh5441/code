setwd("C:/Users/Anshuman/OneDrive/Code/Analytics Edge/Week 5/")
emails = read.csv("emails.csv")
emails = read.csv("emails.csv", stringsAsFactors = FALSE)
library(tm)
library(SnowballC)
corpus = Corpus(VectorSource(emails$text)
)
corpus = tm_map(corpus, tolower)
corpus = tm_map(corpus, removeWords, stopwords("english"))
corpus = tm_map(corpus, removePunctuation)
corpus = tm_map(corpus, removeWords, stopwords("english"))
corpus = tm_map(corpus, stemDocument)
dtm = DocumentTermMatrix(corpus)
corpus = Corpus(VectorSource(emails$email))
corpus = Corpus(VectorSource(emails$text))
corpus = tm_map(corpus, tolower)
corpus = tm_map(corpus, PlainTextDocument)
corpus = tm_map(corpus, removePunctuation)
corpus = tm_map(corpus, removeWords, stopwords("english"))
corpus = tm_map(corpus, stemDocument)
dtm = DocumentTermMatrix(corpus)
str(dtm)
spdtm = removeSparseTerms(dtm, 0.95)
str(spdtm)
emailsSparse = as.data.frame(as.matrix(dtm))
emailsSparse = as.data.frame(as.matrix(spdtm))
colnames(tweetsSparse) = make.names(colnames(tweetsSparse))
colnames(emailsSparse) = make.names(colnames(emailsSparse))
 colSums(emailsSparse)
max(colSums(emailsSparse))
whichmax(colSums(emailsSparse))
which.max(colSums(emailsSparse))
emailsSparse$spam = emails$spam
table(colSums(emailsSparse)>5000,emails$spam)
table(colSums(emailsSparse),emails$spam)
subset(emailsSparse, emailsSparse$spam=1)
subset(emailsSparse, emailsSparse$spam==1)
x = subset(emailsSparse, emailsSparse$spam==1)
str(x)
colSums(x)
x = colSums(subset(emailsSparse, emailsSparse$spam==1))
x
x>5000
sum(x>5000)
sum(x>1000)
sum(colSums(subset(emailsSparse, emailsSparse$spam==1)) > 1000)
sum(colSums(subset(emailsSparse, emailsSparse$spam==0)) > 5000)
sort(colSums(subset(emailsSparse, spam == 0)))
sort(colSums(subset(emailsSparse, spam == 1)))
emailsSparse$spam = as.factor(emailsSparse$spam)
set.seed(123
)
spamLog = glm(spam ~.,data = emailsSparse)
spamLog = glm(spam ~.,data = emailsSparse, method = 'class')
spl = sample.split(emailsSparse$spam, SplitRatio = 0.7)
library(caTools)
spl = sample.split(emailsSparse$spam, SplitRatio = 0.7)
train = subset(emailsSparse, spl ==TRUE)
test = subset(emailsSparse, spl ==FALSE)
spamLog = glm(spam ~.,data = emailsSparse, family = binomial)
library(randomForest)
set.seed(123)
spamCART = rpart(spam ~.,data = emailsSparse, method = 'class')
library(rpart)
spamCART = rpart(spam ~.,data = emailsSparse, method = 'class')
spamRF = randomForest(spam ~.,data = train)
spamLog = glm(spam ~.,data = train, family = binomial)
spamCART = rpart(spam ~.,data = train, method = 'class')
set.seed(123)
spamRF = randomForest(spam ~.,data = train)
predLog = predict(spamLog, newdata = train)
summary(predLog)
predLog = predict(spamLog, type = "response")
summary(predLog)
str(predLog)
predLog<0.00001
sum(predLog<0.00001)
sum(predLog>0.99999)
nrow(predLog)
sum(predLog<0.00001)
str(predLog)
4010 - 3046- 954
predTrainLog = predict(spamLog, type="response")
predTrainCART = predict(spamCART)[,2]
predTrainRF = predict(spamRF, type="prob")[,2]
table(predTrainLog < 0.00001)
table(predTrainLog > 0.99999)
table(predTrainLog >= 0.00001 & predTrainLog <= 0.99999)
summary(spamLog)
library(rpart.plot)
plot(spamCART)
pspamCART
spamCART
table(predLog, train$spam)
table(predLog>0.5, train$spam)
(3052+954)/(3052+954+4)
library(ROCR)
ROCRpred = prediction(predLog, train$spam)
ROCRperf = performance(ROCRpred, "tpr", "fpr")
plot(ROCRperf, colorize=TRUE)
ROCRperf = performance(ROCRpred, "auc")
ROCRperf
table(predTrainCART, train$spam)
table(predTrainCART>0.5, train$spam)
(2885+894)/(2885+894+64+167)
performance(prediction(predTrainCART, train$spam), "auc")
table(predTrainRF>0.5, train$spam)
(3013+914)/(44+39+914+3013)
performance(prediction(predTrainRF, train$spam), "auc")
predTestLog = predict(spamLog,newdata = test, type="response")
table(predTestLog>0.5, test$spam)
(1257+376)/(1257+376+51+34)
performance(prediction(predTestLog, test$spam), "auc")
predTrainCART = predict(spamCART, newdata = test)[,2]
predTrainCART = predict(spamCART,)[,2]
predTrainCART = predict(spamCART)[,2]
predTestCART = predict(spamCART, newdata = test)[,2]
table(predTestCART>0.5, test$spam)
(1228+386)/(1228+80+24+386)
performance(prediction(predTestCART, test$spam), "auc")
predTestRF = predict(spamRF, newdata =test, type="prob")[,2]
table(predTestRF>0.5, test$spam)
(1290+385)/(1290 + 385 + 18 + 25)
performance(prediction(predTestRF, test$spam), "auc")
save.image("C:\\Users\\Anshuman\\OneDrive\\Code\\Analytics Edge\\Week 5\\spam.RData")
q()
